<!DOCTYPE html>
<html lang="en">
<head>
<!-- HTML header for doxygen 1.8.12 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Benchmark Python* Tool - OpenVINO Toolkit</title>
<script type="text/javascript" src="jquery.js?v=061b82a77ebb139b894ce81faa5ba1f6"></script>
<script type="text/javascript" src="dynsections.js?v=061b82a77ebb139b894ce81faa5ba1f6"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../assets/versions_raw.js?v=061b82a77ebb139b894ce81faa5ba1f6"></script>
<script type="text/javascript" src="../assets/openvino-versions.js?v=061b82a77ebb139b894ce81faa5ba1f6"></script>
<script type="text/javascript" src="openvino-layout.js?v=061b82a77ebb139b894ce81faa5ba1f6"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <div id="projectalign">
   <div id="projectname"><a href="<domain_placeholder>" class="homelink-id">OpenVINO Toolkit</a></div>
  </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js?v=e23bd1c8e92f867d90ca8af9d83669a3"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Benchmark Python* Tool </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This topic demonstrates how to run the Benchmark Python* Tool, which performs inference using convolutional networks. Performance can be measured for two inference modes: synchronous (latency-oriented) and asynchronous (throughput-oriented).</p>
<blockquote class="doxtable">
<p><b>NOTE:</b> This topic describes usage of Python implementation of the Benchmark Tool. For the C++ implementation, refer to <a class="el" href="_inference_engine_samples_benchmark_app_README.html">Benchmark C++ Tool</a>. </p>
</blockquote>
<h2>How It Works</h2>
<p>Upon start-up, the application reads command-line parameters and loads a network and images/binary files to the Inference Engine plugin, which is chosen depending on a specified device. The number of infer requests and execution approach depend on the mode defined with the <code>-api</code> command-line parameter.</p>
<blockquote class="doxtable">
<p><b>NOTE</b>: By default, Inference Engine samples, tools and demos expect input with BGR channels order. If you trained your model to work with RGB order, you need to manually rearrange the default channels order in the sample or demo application or reconvert your model using the Model Optimizer tool with <code>--reverse_input_channels</code> argument specified. For more information about the argument, refer to <b>When to Reverse Input Channels</b> section of <a class="el" href="_docs_MO_DG_prepare_model_convert_model_Converting_Model_General.html">Converting a Model Using General Conversion Parameters</a>. </p>
</blockquote>
<h3>Synchronous API</h3>
<p>For synchronous mode, the primary metric is latency. The application creates one infer request and executes the <code>Infer</code> method. A number of executions is defined by one of the two values:</p><ul>
<li>Number of iterations defined with the <code>-niter</code> command-line argument</li>
<li>Time duration specified with the <code>-t</code> command-line argument</li>
<li>Both of them (execution will continue until both conditions are met)</li>
<li>Predefined duration if <code>-niter</code> and <code>-t</code> are not specified. Predefined duration value depends on device.</li>
</ul>
<p>During the execution, the application collects two types of metrics:</p><ul>
<li>Latency for each infer request executed with <code>Infer</code> method</li>
<li>Duration of all executions</li>
</ul>
<p>Reported latency value is calculated as mean value of all collected latencies. Reported throughput value is a derivative from reported latency and additionally depends on batch size.</p>
<h3>Asynchronous API</h3>
<p>For asynchronous mode, the primary metric is throughput in frames per second (FPS). The application creates a certain number of infer requests and executes the <code>StartAsync</code> method. A number of executions is defined by one of the two values:</p><ul>
<li>Number of iterations defined with the <code>-niter</code> command-line argument</li>
<li>Time duration specified with the <code>-t</code> command-line argument</li>
<li>Both of them (execution will continue until both conditions are met)</li>
<li>Predefined duration if <code>-niter</code> and <code>-t</code> are not specified. Predefined duration value depends on device.</li>
</ul>
<p>The infer requests are executed asynchronously. Callback is used to wait for previous execution to complete. The application measures all infer requests executions and reports the throughput metric based on batch size and total execution duration.</p>
<h2>Run the Tool</h2>
<p>Notice that the benchmark_app usually produces optimal performance for any device out of the box.</p>
<p><b>So in most cases you don't need to play the app options explicitly and the plain device name is enough</b>, for example, for CPU: </p><div class="fragment"><div class="line">python3 benchmark_app.py -m &lt;model&gt; -i &lt;input&gt; -d CPU</div></div><!-- fragment --><p>But it is still may be non-optimal for some cases, especially for very small networks. More details can read in <a class="el" href="_docs_IE_DG_Intro_to_Performance.html">Introduction to Performance Topics</a>.</p>
<p>Running the application with the <code>-h</code> or <code>--help</code>' option yields the following usage message:</p>
<div class="fragment"><div class="line">usage: benchmark_app.py [-h] [-i PATH_TO_INPUT] -m PATH_TO_MODEL</div><div class="line">                        [-d TARGET_DEVICE]</div><div class="line">                        [-l PATH_TO_EXTENSION] [-c PATH_TO_CLDNN_CONFIG]</div><div class="line">                        [-api {sync,async}] [-niter NUMBER_ITERATIONS]</div><div class="line">                        [-b BATCH_SIZE]</div><div class="line">                        [-stream_output [STREAM_OUTPUT]] [-t TIME]</div><div class="line">                        [-progress [PROGRESS]] [-nstreams NUMBER_STREAMS]</div><div class="line">                        [-nthreads NUMBER_THREADS] [-pin {YES,NO}]</div><div class="line">                        [--exec_graph_path EXEC_GRAPH_PATH]</div><div class="line">                        [-pc [PERF_COUNTS]]</div><div class="line"></div><div class="line">Options:</div><div class="line">  -h, --help            Show this help message and exit.</div><div class="line">  -i PATH_TO_INPUT, --path_to_input PATH_TO_INPUT</div><div class="line">                        Optional. Path to a folder with images and/or binaries</div><div class="line">                        or to specific image or binary file.</div><div class="line">  -m PATH_TO_MODEL, --path_to_model PATH_TO_MODEL</div><div class="line">                        Required. Path to an .xml file with a trained model.</div><div class="line">  -d TARGET_DEVICE, --target_device TARGET_DEVICE</div><div class="line">                        Optional. Specify a target device to infer on: CPU,</div><div class="line">                        GPU, FPGA, HDDL or MYRIAD.</div><div class="line">                        Use &quot;-d HETERO:&lt;comma separated devices list&gt;&quot; format to specify HETERO plugin.</div><div class="line">                        Use &quot;-d MULTI:&lt;comma separated devices list&gt;&quot; format to specify MULTI plugin.</div><div class="line">                        The application looks for a suitable plugin for the specified device.</div><div class="line">  -l PATH_TO_EXTENSION, --path_to_extension PATH_TO_EXTENSION</div><div class="line">                        Optional. Required for CPU custom layers. Absolute</div><div class="line">                        path to a shared library with the kernels</div><div class="line">                        implementations.</div><div class="line">  -c PATH_TO_CLDNN_CONFIG, --path_to_cldnn_config PATH_TO_CLDNN_CONFIG</div><div class="line">                        Optional. Required for GPU custom kernels. Absolute</div><div class="line">                        path to an .xml file with the kernels description.</div><div class="line">  -api {sync,async}, --api_type {sync,async}</div><div class="line">                        Optional. Enable using sync/async API. Default value</div><div class="line">                        is async.</div><div class="line">  -niter NUMBER_ITERATIONS, --number_iterations NUMBER_ITERATIONS</div><div class="line">                        Optional. Number of iterations. If not specified, the</div><div class="line">                        number of iterations is calculated depending on a</div><div class="line">                        device.</div><div class="line">  -b BATCH_SIZE, --batch_size BATCH_SIZE</div><div class="line">                        Optional. Batch size value. If not specified, the</div><div class="line">                        batch size value is determined from IR</div><div class="line">  -stream_output [STREAM_OUTPUT]</div><div class="line">                        Optional. Print progress as a plain text. When</div><div class="line">                        specified, an interactive progress bar is replaced</div><div class="line">                        with a multiline output.</div><div class="line">  -t TIME, --time TIME  Optional. Time in seconds to execute topology.</div><div class="line">  -progress [PROGRESS]  Optional. Show progress bar (can affect performance</div><div class="line">                        measurement). Default values is &quot;False&quot;.</div><div class="line">  -nstreams NUMBER_STREAMS, --number_streams NUMBER_STREAMS</div><div class="line">                       Optional. Number of streams to use for inference on the CPU/GPU in throughput mode</div><div class="line">                       (for HETERO and MULTI device cases use format &lt;device1&gt;:&lt;nstreams1&gt;,&lt;device2&gt;:&lt;nstreams2&gt; or just &lt;nstreams&gt;).</div><div class="line">                       Default value is determined automatically for a device. </div><div class="line">                       Please note that although the automatic selection usually provides a reasonable performance, </div><div class="line">                       it still may be non-optimal for some cases, especially for very small networks.</div><div class="line">  -nthreads NUMBER_THREADS, --number_threads NUMBER_THREADS</div><div class="line">                        Number of threads to use for inference on the CPU</div><div class="line">                        (including HETERO  and MULTI cases).</div><div class="line">  -pin {YES,NO}, --infer_threads_pinning {YES,NO}</div><div class="line">                        Optional. Enable (&quot;YES&quot; is default value) or disable</div><div class="line">                        (&quot;NO&quot;)CPU threads pinning for CPU-involved inference.</div><div class="line">  --exec_graph_path EXEC_GRAPH_PATH</div><div class="line">                        Optional. Path to a file where to store executable</div><div class="line">                        graph information serialized.</div><div class="line">  -pc [PERF_COUNTS], --perf_counts [PERF_COUNTS]</div><div class="line">                        Optional. Report performance counters.</div></div><!-- fragment --><p>Running the application with the empty list of options yields the usage message given above and an error message.</p>
<p>Application supports topologies with one or more inputs. If a topology is not data sensitive, you can skip the input parameter. In this case, inputs are filled with random values. If a model has only image input(s), please a provide folder with images or a path to an image as input. If a model has some specific input(s) (not images), please prepare a binary file(s), which is filled with data of appropriate precision and provide a path to them as input. If a model has mixed input types, input folder should contain all required files. Image inputs are filled with image files one by one. Binary inputs are filled with binary inputs one by one.</p>
<p>To run the tool, you can use public or Intel's pre-trained models. To download the models, use the OpenVINO <a class="el" href="_tools_downloader_README.html">Model Downloader</a> or go to <a href="https://download.01.org/opencv/">https://download.01.org/opencv/</a>.</p>
<blockquote class="doxtable">
<p><b>NOTE</b>: Before running the tool with a trained model, make sure the model is converted to the Inference Engine format (*.xml + *.bin) using the <a class="el" href="_docs_MO_DG_Deep_Learning_Model_Optimizer_DevGuide.html">Model Optimizer tool</a>. </p>
</blockquote>
<h2>Examples of Running the Tool</h2>
<p>This section provides step-by-step instructions on how to run the Benchmark Tool with the <code>googlenet-v1</code> public model on CPU or FPGA devices. As an input, the <code>car.png</code> file from the <code>&lt;INSTALL_DIR&gt;/deployment_tools/demo/</code> directory is used.</p>
<blockquote class="doxtable">
<p><b>NOTE:</b> The Internet access is required to execute the following steps successfully. If you have access to the Internet through the proxy server only, please make sure that it is configured in your OS environment. </p>
</blockquote>
<ol type="1">
<li>Download the model. Go to the the Model Downloader directory and run the <code>downloader.py</code> script with specifying the model name and directory to download the model to: <div class="fragment"><div class="line">cd &lt;INSTAL_DIR&gt;/deployment_tools/open_model_zoo/tools/downloader</div></div><!-- fragment --> <div class="fragment"><div class="line">python3 downloader.py --name googlenet-v1 -o &lt;models_dir&gt;</div></div><!-- fragment --></li>
<li>Convert the model to the Inference Engine IR format. Go to the Model Optimizer directory and run the <code>mo.py</code> script with specifying the path to the model, model format (which must be FP32 for CPU and FPG) and output directory to generate the IR files: <div class="fragment"><div class="line">cd &lt;INSTALL_DIR&gt;/deployment_tools/model_optimizer</div></div><!-- fragment --> <div class="fragment"><div class="line">python3 mo.py --input_model &lt;models_dir&gt;/public/googlenet-v1/googlenet-v1.caffemodel --data_type FP32 --output_dir &lt;ir_dir&gt;</div></div><!-- fragment --></li>
<li>Run the tool with specifying the <code>&lt;INSTALL_DIR&gt;/deployment_tools/demo/car.png</code> file as an input image, the IR of the <code>googlenet-v1</code> model and a device to perform inference on. The following commands demonstrate running the Benchmark Tool in the asynchronous mode on CPU and FPGA devices:<ul>
<li>On CPU: <div class="fragment"><div class="line">python3 benchmark_app.py -m &lt;ir_dir&gt;/googlenet-v1.xml -d CPU -api async -i &lt;INSTALL_DIR&gt;/deployment_tools/demo/car.png --progress true -b 1</div></div><!-- fragment --></li>
<li>On FPGA: <div class="fragment"><div class="line">python3 benchmark_app.py -m &lt;ir_dir&gt;/googlenet-v1.xml -d HETERO:FPGA,CPU -api async -i &lt;INSTALL_DIR&gt;/deployment_tools/demo/car.png --progress true -b 1</div></div><!-- fragment --></li>
</ul>
</li>
</ol>
<p>The application outputs number of executed iterations, total duration of execution, latency and throughput. Additionally, if you set the <code>-pc</code> parameter, the application outputs performance counters. If you set <code>-exec_graph_path</code>, the application reports executable graph information serialized.</p>
<p>Below are fragments of sample output for CPU and FPGA devices:</p><ul>
<li>For CPU: <div class="fragment"><div class="line">[Step 8/9] Measuring performance (Start inference asyncronously, 60000 ms duration, 4 inference requests in parallel using 4 streams)</div><div class="line">Progress: |................................| 100.00%</div><div class="line"></div><div class="line">[Step 9/9] Dumping statistics report</div><div class="line">Progress: |................................| 100.00%</div><div class="line"></div><div class="line">Count:      4408 iterations</div><div class="line">Duration:   60153.52 ms</div><div class="line">Latency:    51.8244 ms</div><div class="line">Throughput: 73.28 FPS</div></div><!-- fragment --></li>
<li>For FPGA: <div class="fragment"><div class="line">[Step 10/11] Measuring performance (Start inference asyncronously, 5 inference requests using 1 streams for CPU, limits: 120000 ms duration)</div><div class="line">Progress: |................................| 100%</div><div class="line"></div><div class="line">[Step 11/11] Dumping statistics report</div><div class="line">Count:      98075 iterations</div><div class="line">Duration:   120011.03 ms</div><div class="line">Latency:    5.65 ms</div><div class="line">Throughput: 817.22 FPS</div></div><!-- fragment --></li>
</ul>
<h2>See Also</h2>
<ul>
<li><a class="el" href="_docs_IE_DG_Samples_Overview.html">Using Inference Engine Samples</a></li>
<li><a class="el" href="_docs_MO_DG_Deep_Learning_Model_Optimizer_DevGuide.html">Model Optimizer</a></li>
<li><a class="el" href="_tools_downloader_README.html">Model Downloader</a> </li>
</ul>
</div></div><!-- contents -->
  <div class="footer">
  <div id="nav-path" class="navpath"></div>
  <div class="footer-content">
    <div class="footer-column">
      <h4>Support</h4>
      <ul>
        <li>
          <a href="https://software.intel.com/en-us/forums/computer-vision">Intel Developer Zone Forum for Intel Distribution of OpenVINO Toolkit</a></li>
      </ul>
    </div>
  </div>
  <div class="copyright">
    <p>Documentation for OpenVINO Toolkit.<br/>
    For more complete information about compiler optimizations, see our <a href="/<version_placeholder>/_docs_IE_DG_Optimization_notice.html">Optimization Notice</a></p>
  </div>
</div>
</body>
</html>